---
title: "Getting Data Into R"
author: "Dr Ahmed Al-Hindawi"
date: "13 April 2016"
output: ioslides_presentation
---

## Aims

Getting Data into R can be accomplished in many ways.

1. Using in-built functions to import CSV files
2. Workshop to get this working
3. Using GoogleSheets
4. Workshop to demonstrated

## Everything is a "data-frame"

Once you have imported any sheet into R, the result is a data-frame. This is another word for a sheet - like Excel's sheet; it has columns, each identified by a name, and rows for observations.

To access a dataframe's particular column, we use the $ notation. E.g:

```{r, eval=FALSE}
df$some_column
```

Here, `df` is our dataframe and the column name is "some_column".

## Introducing the CSV

CSV, a Comma Seperated Values, is a file that will contain your data. This is easily exportable from Microsoft Excel, Apple Numbers, Open Office, Google Sheets...etc.

It's a simple format. The top line are the column names, each seperated by a comma. The following lines are the observations in those columns, again, seperated by a comma.

It's strength is in it's simplicity. It only has data, no formuals, no tricks and is very well recognised amongst software packages as it is very easily supported. R has excellent support for CSV.

## Export CSV From Excel

```{r, out.width = 750, fig.retina = NULL, echo=FALSE}
knitr::include_graphics("figures/export_csv.png")
```

## Find your File

You will need to know the absolute location of your file on your harddrive.

```{r, out.width = 380, fig.retina = NULL, echo=FALSE}
knitr::include_graphics("figures/mac_path.png")
```

## File your File
This will result in the following path:

```{r, eval=FALSE}
/Users/ahmedalhindawi/Documents/Development/Man_graph.xls
```

On Windows: Shift+Right click on file. Choose Copy As Path. A similar path will appear.

## Using in-built function

We can import Comma Separated Values (CSV) files into R very easily. These files can be generated by Microsoft Excel, Apple Numbers and Google Sheets usually through a File -> Export process.

Once a sheet has been exported, it can be imported into R:


```{r, eval=FALSE}
FILE <- "/Users/ahmedalhindawi/Documents/Development/Man_graph.xls"
df <- read.csv(FILE, header=TRUE, stringsAsFactor=FALSE)
```

This will read your file, then a dataframe object will be available to run queries on. To display the entire column, type:

```{r, eval=FALSE}
df$column_name
```

## Workshop

Now is a 20 minute workshop on getting this working...

## Using Google Sheets

Using Google Sheets is a slightly more advanced way of getting data into R but it is more powerful. It allows the creation of seamless data analytics. Using Google Forms, one can input the data into a pre-validated form that then gets automatically inserted into a sheet that then gets pulled in automatically into R next time you run your script.

## Install Libraries

We will need to install the `googlesheets` library to import data from Google Sheets.

```{r, eval=FALSE}
install.packages("googlesheets")
```

Once the package has been installed, load it into your R script:

```{r, eval=FALSE}
library("googlesheets"")
```

## Accessing Sheet
Now list all the sheets available (local and ones shared to your account as shown https://docs.google.com/spreadsheets/) using

```{r, eval=FALSE}
gs_ls()
```

On the first run, it will ask you to authorise the package 'googlespreadsheet' to view your account by copying a link from the console and pasting it into a browser. Once you have authorised it, you will receive a code from your browser which you can then paste into the console. A list of all your sheets will then be printed in the console.

## Accessing Sheet
To access the sheet:

```{r, eval=FALSE}
    sheet <- gs_title(YOUR_TITLE)
```

Where YOUR_TITLE is the name of the sheet as shown in the gs_ls command. gs_title will authorise the use of that sheet.

To get access to the worksheet:

```{r, eval=FALSE}
    df <- gs_read(ss = sheet, ws = NAME_OF_WORKSHEET)
```

data variable now contains a dataframe much like importing from CSV. You can access columns by:

```{r, eval=FALSE}
    df$column_name
```

## Alternatively

You can get the "key" of the googlesheet from the URL (the long big).

```{r, eval=FALSE}
gap <- gs_key("1rAkCgL9qsUYw0wxRyb6R-JKpb8694Te0VqGlbM1Gh2w")

df <- gs_read_csv(ss=gap, ws = "Form responses 1")
```

The sheet needs to be "public" through File -> Publish To The Web

## Questions?
